{% extends "free_base.html" %}
{% load static %}
{% block title %}Safaricom Packages{% endblock title %}
{% block content %}
<section id="pricing" class="pricing-table style2 section">
    <div class="container">
        {% if request.user.is_superuser or request.user.is_staff %}
        <button class="btn btn-success d-flex float-end align-items-center align-center" id="addPackageBtn">
            <i class="fa-solid fa-plus"></i>
        </button>
        {% endif %}

        <div class="row">
            <div class="col-12">
                <div class="section-title d-flex justify-content-center align-items-center mb-5">
                    <h2 class="wow zoomIn" data-wow-delay=".2s">Safaricom Packages</h2>
                </div>
            </div>
        </div>

        <!-- DATA BUNDLES SECTION -->
        <div class="category-section mb-5">
            <div class="row">
                <div class="col-12">
                    <div class="category-header d-flex align-items-center mb-4">
                        <div class="category-icon me-3">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect width="40" height="40" rx="20" fill="#E5F6FF"/>
                                <path d="M26 14H14C12.9 14 12 14.9 12 16V24C12 25.1 12.9 26 14 26H26C27.1 26 28 25.1 28 24V16C28 14.9 27.1 14 26 14ZM20 24C18.62 24 17.5 22.88 17.5 21.5V18.5C17.5 17.12 18.62 16 20 16C21.38 16 22.5 17.12 22.5 18.5V21.5C22.5 22.88 21.38 24 20 24ZM25 17.5H23V16H25V17.5ZM25 20H23V18.5H25V20ZM25 22.5H23V21H25V22.5Z" fill="#0046AD"/>
                            </svg>
                        </div>
                        <h3 class="mb-0 text-primary">Data Bundles</h3>
                    </div>
                </div>
            </div>

            <div class="row">
                {% for package in packages %}
                {% if package.category == 'DATA' %}
                <div class="col-md-4 wow fadeInUp" data-wow-delay=".4s">
                    <div class="card shadow-sm mb-4 hover-elevation" style="border-radius: 15px; border: 1px solid #198754;">
                        <div class="card-body p-3">
                            <div class="text-center mb-3">
                                <img src="{% static 'images/logo/safaricom.png' %}" alt="Safaricom" class="img-fluid" style="max-height: 30px;">
                            </div>
                            <!-- Edit and Delete buttons positioned at top-right -->
                            {% if request.user.is_superuser or request.user.is_staff %}
                            <div class="d-flex justify-content-end mb-2">
                                <button class="btn btn-sm btn-warning rounded-circle me-2 editPackageBtn"
                                       data-package-id="{{package.id}}"
                                       data-package-name="{{package.name}}"
                                       data-package-price="{{package.price}}"
                                       data-package-category="{{package.category}}">
                                        <i class="fa-solid fa-pen-to-square"></i>
                                </button>
                                <button class="btn btn-sm btn-danger rounded-circle deletePackageBtn"
                                       data-package-id="{{package.id}}"
                                       data-package-name="{{package.name}}">
                                        <i class="fa-solid fa-trash"></i>
                                </button>
                            </div>
                            {% endif %}
               
                            <!-- Package Icon and Details -->
                            <div class="d-flex align-items-center mb-2">
                                <div class="package-icon me-2">
                                    <svg width="30" height="30" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20 6C12.268 6 6 12.268 6 20C6 27.732 12.268 34 20 34C27.732 34 34 27.732 34 20C34 12.268 27.732 6 20 6Z" fill="#0046AD"/>
                                        <path d="M16.75 14C16.75 12.208 18.208 10.75 20 10.75C21.792 10.75 23.25 12.208 23.25 14C23.25 15.792 21.792 17.25 20 17.25C18.208 17.25 16.75 15.792 16.75 14Z" fill="#00A651"/>
                                        <path d="M14 20C14 18.208 15.458 16.75 17.25 16.75C19.042 16.75 20.5 18.208 20.5 20C20.5 21.792 19.042 23.25 17.25 23.25C15.458 23.25 14 21.792 14 20Z" fill="#00A651"/>
                                        <path d="M17.25 22.75C17.25 20.958 18.708 19.5 20.5 19.5C22.292 19.5 23.75 20.958 23.75 22.75C23.75 24.542 22.292 26 20.5 26C18.708 26 17.25 24.542 17.25 22.75Z" fill="#00A651"/>
                                    </svg>
                                </div>
                                <div class="package-details">
                                    <span class="text-success fw-bold">{{package.name}}</span>
                                </div>
                            </div>
               
                            <div class="mb-3">
                                <small class="text-muted">Kes</small>
                                <span class="fw-bold" style="font-size: 24px;">{{package.price}}</span>
                            </div>
               
                            <button class="btn btn-primary w-100 py-2 openModalBtn"
                                    style="border-radius: 10px; background-color: #0046AD; border: none; font-weight: 500;"
                                    data-package-name="{{package.name}}"
                                    data-package-price="{{package.price}}">
                                Purchase
                            </button>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
                
                {% if not packages|dictsortreversed:"category"|first %}
                <div class="col-12 text-center wow fadeInUp" data-wow-delay=".4s">
                    <div class="alert alert-info p-4 shadow-sm">
                        <i class="fa-solid fa-info-circle me-2"></i>
                        <span>No data bundles available at the moment. Please check back later.</span>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- SMS BUNDLES SECTION -->
        <div class="category-section mb-5">
            <div class="row">
                <div class="col-12">
                    <div class="category-header d-flex align-items-center mb-4">
                        <div class="category-icon me-3">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect width="40" height="40" rx="20" fill="#FFF4E5"/>
                                <path d="M28 14H12C10.9 14 10 14.9 10 16V24C10 25.1 10.9 26 12 26H28C29.1 26 30 25.1 30 24V16C30 14.9 29.1 14 28 14ZM28 16V16.5L20 21.5L12 16.5V16H28ZM12 24V18.8L19.6 23.55C19.8 23.7 20.2 23.7 20.4 23.55L28 18.8V24H12Z" fill="#FF9800"/>
                            </svg>
                        </div>
                        <h3 class="mb-0 text-warning">SMS Bundles</h3>
                    </div>
                </div>
            </div>

            <div class="row">
                {% for package in packages %}
                {% if package.category == 'SMS' %}
                <div class="col-md-4 wow fadeInUp" data-wow-delay=".4s">
                    <div class="card shadow-sm mb-4 hover-elevation" style="border-radius: 15px; border: 1px solid #0046AD;">
                        <div class="card-body p-3">
                            <div class="text-center mb-3">
                                <img src="{% static 'images/logo/safaricom.png' %}" alt="Safaricom" class="img-fluid" style="max-height: 30px;">
                            </div>
                            <!-- Edit and Delete buttons positioned at top-right -->
                            {% if request.user.is_superuser or request.user.is_staff %}
                            <div class="d-flex justify-content-end mb-2">
                                <button class="btn btn-sm btn-warning rounded-circle me-2 editPackageBtn"
                                       data-package-id="{{package.id}}"
                                       data-package-name="{{package.name}}"
                                       data-package-price="{{package.price}}"
                                       data-package-category="{{package.category}}">
                                        <i class="fa-solid fa-pen-to-square"></i>
                                </button>
                                <button class="btn btn-sm btn-danger rounded-circle deletePackageBtn"
                                       data-package-id="{{package.id}}"
                                       data-package-name="{{package.name}}">
                                        <i class="fa-solid fa-trash"></i>
                                </button>
                            </div>
                            {% endif %}
               
                            <!-- Package Icon and Details -->
                            <div class="d-flex align-items-center mb-2">
                                <div class="package-icon me-2">
                                    <svg width="30" height="30" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20 6C12.268 6 6 12.268 6 20C6 27.732 12.268 34 20 34C27.732 34 34 27.732 34 20C34 12.268 27.732 6 20 6Z" fill="#FF9800"/>
                                        <path d="M26 15H14C13.448 15 13 15.448 13 16V24C13 24.552 13.448 25 14 25H26C26.552 25 27 24.552 27 24V16C27 15.448 26.552 15 26 15ZM25 17V17.25L20 20.75L15 17.25V17H25ZM15 23V19.25L19.6 22.45C19.8 22.6 20.2 22.6 20.4 22.45L25 19.25V23H15Z" fill="#FFFFFF"/>
                                    </svg>
                                </div>
                                <div class="package-details">
                                    <span class="text-success fw-bold">{{package.name}}</span>
                                </div>
                            </div>
               
                            <div class="mb-3">
                                <small class="text-muted">Kes</small>
                                <span class="fw-bold" style="font-size: 24px;">{{package.price}}</span>
                            </div>
               
                            <button class="btn w-100 py-2 openModalBtn"
                                    style="border-radius: 10px; background-color:#0046AD; color: white; border: none; font-weight: 500;"
                                    data-package-name="{{package.name}}"
                                    data-package-price="{{package.price}}">
                                Purchase
                            </button>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
                
                {% if not packages|dictsortreversed:"category"|first %}
                <div class="col-12 text-center wow fadeInUp" data-wow-delay=".4s">
                    <div class="alert alert-warning p-4 shadow-sm">
                        <i class="fa-solid fa-info-circle me-2"></i>
                        <span>No SMS bundles available at the moment. Please check back later.</span>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- MINUTES BUNDLES SECTION -->
        <div class="category-section mb-5">
            <div class="row">
                <div class="col-12">
                    <div class="category-header d-flex align-items-center mb-4">
                        <div class="category-icon me-3">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect width="40" height="40" rx="20" fill="#F0FFF0"/>
                                <path d="M20 10C14.48 10 10 14.48 10 20C10 25.52 14.48 30 20 30C25.52 30 30 25.52 30 20C30 14.48 25.52 10 20 10ZM26 22H20C19.45 22 19 21.55 19 21V15C19 14.45 19.45 14 20 14C20.55 14 21 14.45 21 15V19H26C26.55 19 27 19.45 27 20C27 20.55 26.55 22 26 22Z" fill="#0046AD"/>
                            </svg>
                        </div>
                        <h3 class="mb-0 text-success">Minutes Bundles</h3>
                    </div>
                </div>
            </div>

            <div class="row">
                {% for package in packages %}
                {% if package.category == 'MINUTES' %}
                <div class="col-md-4 wow fadeInUp" data-wow-delay=".4s">
                    <div class="card shadow-sm mb-4 hover-elevation" style="border-radius: 15px; border: 1px solid #0046AD;">
                        <div class="card-body p-3">
                            <div class="text-center mb-3">
                                <img src="{% static 'images/logo/safaricom.png' %}" alt="Safaricom" class="img-fluid" style="max-height: 30px;">
                            </div>
                            <!-- Edit and Delete buttons positioned at top-right -->
                            {% if request.user.is_superuser or request.user.is_staff %}
                            <div class="d-flex justify-content-end mb-2">
                                <button class="btn btn-sm btn-warning rounded-circle me-2 editPackageBtn"
                                    data-package-id="{{package.id}}"
                                    data-package-name="{{package.name}}"
                                    data-package-price="{{package.price}}"
                                    data-package-category="{{package.category}}">
                                    <i class="fa-solid fa-pen-to-square"></i>
                                </button>
                                <button class="btn btn-sm btn-danger rounded-circle deletePackageBtn"
                                       data-package-id="{{package.id}}"
                                       data-package-name="{{package.name}}">
                                        <i class="fa-solid fa-trash"></i>
                                </button>
                            </div>
                            {% endif %}
               
                            <!-- Package Icon and Details -->
                            <div class="d-flex align-items-center mb-2">
                                <div class="package-icon me-2">
                                    <svg width="30" height="30" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20 6C12.268 6 6 12.268 6 20C6 27.732 12.268 34 20 34C27.732 34 34 27.732 34 20C34 12.268 27.732 6 20 6Z" fill="#0046AD"/>
                                        <path d="M19.5 12V20.25L26.5 24.5L27.5 22.8L21.5 19.25V12H19.5Z" fill="#FFFFFF"/>
                                    </svg>
                                </div>
                                <div class="package-details">
                                    <span class="text-success fw-bold">{{package.name}}</span>
                                </div>
                            </div>
               
                            <div class="mb-3">
                                <small class="text-muted">Kes</small>
                                <span class="fw-bold" style="font-size: 24px;">{{package.price}}</span>
                            </div>
               
                            <button class="btn w-100 py-2 openModalBtn"
                                    style="border-radius: 10px; background-color: #0046AD; color: white; border: none; font-weight: 500;"
                                    data-package-name="{{package.name}}"
                                    data-package-price="{{package.price}}">
                                Purchase
                            </button>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
                
                {% if not packages|dictsortreversed:"category"|first %}
                <div class="col-12 text-center wow fadeInUp" data-wow-delay=".4s">
                    <div class="alert alert-success p-4 shadow-sm">
                        <i class="fa-solid fa-info-circle me-2"></i>
                        <span>No Minutes bundles available at the moment. Please check back later.</span>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
<!--/ End Pricing Table Area -->

<!-- SHARE SECTION -->
<div class="category-section my-5">
    <div class="row">
        <div class="col-12 ">
            <div class="category-header justify-content-center d-flex align-items-center mb-4">
                <div class="category-icon me-3">
                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="48" height="48" rx="24" fill="#EBF5FF"/>
                        <path d="M32 16C32 12.68 29.32 10 26 10C22.68 10 20 12.68 20 16C20 16.3 20.04 16.6 20.1 16.9L15.7 19.3C14.7 18.5 13.4 18 12 18C8.7 18 6 20.7 6 24C6 27.3 8.7 30 12 30C13.4 30 14.7 29.5 15.7 28.7L20.1 31.1C20.04 31.4 20 31.7 20 32C20 35.32 22.68 38 26 38C29.32 38 32 35.32 32 32C32 28.68 29.32 26 26 26C24.6 26 23.3 26.5 22.3 27.3L17.9 24.9C17.96 24.6 18 24.3 18 24C18 23.7 17.96 23.4 17.9 23.1L22.3 20.7C23.3 21.5 24.6 22 26 22C29.32 22 32 19.32 32 16Z" fill="#0046AD"/>
                    </svg>
                </div>
                <h2 class="mb-0 fw-bold text-primary">Share & Save</h2>
            </div>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-12">
            <div class="card shadow p-4" style="border-radius: 24px; border: none; background: linear-gradient(135deg, #f8faff 0%, #e6f0ff 100%);">
                <div class="share-content text-center mb-4">
                    <h4 class="fw-bold mb-3" style="color: #0046AD;">Help Your Friends Stay Connected</h4>
                    <p class="lead mb-0" style="color: #555;">Share these exclusive Safaricom packages with your network and help them save too!</p>
                </div>
                
                <div class="share-buttons-container">
                    <div class="d-flex justify-content-center flex-wrap gap-3">
                        <!-- WhatsApp Share Button -->
                        <button id="shareWhatsApp" class="share-btn share-btn-lg d-flex align-items-center justify-content-center shadow-sm" style="background-color: #25D366; color: white; border-radius: 16px; min-width: 160px; transition: all 0.3s ease;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-whatsapp me-2" viewBox="0 0 16 16">
                                <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"/>
                            </svg>
                            <span class="fw-bold">WhatsApp</span>
                        </button>
                        
                        <!-- Facebook Share Button -->
                        <button id="shareFacebook" class="share-btn share-btn-lg d-flex align-items-center justify-content-center shadow-sm" style="background-color: #1877F2; color: white; border-radius: 16px; min-width: 160px; transition: all 0.3s ease;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-facebook me-2" viewBox="0 0 16 16">
                                <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"/>
                            </svg>
                            <span class="fw-bold">Facebook</span>
                        </button>
                        
                        <!-- X (Twitter) Share Button -->
                        <button id="shareTwitter" class="share-btn share-btn-lg d-flex align-items-center justify-content-center shadow-sm" style="background-color: #000000; color: white; border-radius: 16px; min-width: 160px; transition: all 0.3s ease;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-twitter-x me-2" viewBox="0 0 16 16">
                                <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/>
                            </svg>
                            <span class="fw-bold">X</span>
                        </button>
                        
                        <!-- Instagram Share Button -->
                        <button id="shareInstagram" class="share-btn share-btn-lg d-flex align-items-center justify-content-center shadow-sm" style="background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); color: white; border-radius: 16px; min-width: 160px; transition: all 0.3s ease;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-instagram me-2" viewBox="0 0 16 16">
                                <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"/>
                            </svg>
                            <span class="fw-bold">Instagram</span>
                        </button>
                        
                        <!-- SMS Share Button -->
                        <button id="shareSMS" class="share-btn share-btn-lg d-flex align-items-center justify-content-center shadow-sm" style="background-color: #5BC236; color: white; border-radius: 16px; min-width: 160px; transition: all 0.3s ease;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-chat-dots me-2" viewBox="0 0 16 16">
                                <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z"/>
                            </svg>
                            <span class="fw-bold">SMS</span>
                        </button>
                    </div>
                </div>
                
                <div class="share-footer text-center mt-4 pt-3" style="border-top: 1px dashed #dee2e6;">
                    <p class="mb-0" style="color: #666;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#0046AD" class="bi bi-info-circle-fill me-1" viewBox="0 0 16 16">
                            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                        </svg>
                        Get exclusive deals when you share and your friends subscribe!
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Purchase Modal with Form -->
<div id="purchaseModal" class="saf-modal">
    <div class="saf-modal-content">
        <form id="mpesaPaymentForm" method="POST" action="{% url 'initiate_payment' %} ">
            {% csrf_token %}
            <input type="hidden" id="package_id" name="package_id" value="">
            <input type="hidden" id="amount" name="amount" value="">
           
            <div class="saf-modal-header">
                <svg class="saf-logo" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 6C12.268 6 6 12.268 6 20C6 27.732 12.268 34 20 34C27.732 34 34 27.732 34 20C34 12.268 27.732 6 20 6Z" fill="#0046AD"/>
                    <path d="M16.75 14C16.75 12.208 18.208 10.75 20 10.75C21.792 10.75 23.25 12.208 23.25 14C23.25 15.792 21.792 17.25 20 17.25C18.208 17.25 16.75 15.792 16.75 14Z" fill="#00A651"/>
                    <path d="M14 20C14 18.208 15.458 16.75 17.25 16.75C19.042 16.75 20.5 18.208 20.5 20C20.5 21.792 19.042 23.25 17.25 23.25C15.458 23.25 14 21.792 14 20Z" fill="#00A651"/>
                    <path d="M17.25 22.75C17.25 20.958 18.708 19.5 20.5 19.5C22.292 19.5 23.75 20.958 23.75 22.75C23.75 24.542 22.292 26 20.5 26C18.708 26 17.25 24.542 17.25 22.75Z" fill="#00A651"/>
                </svg>
            </div>
            <div class="saf-modal-body">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title mb-3">Package Details</h5>
                        <div class="d-flex justify-content-between mb-3">
                            <span>Package:</span>
                            <span class="fw-bold" id="modalPackageName"></span>
                        </div>
                        <div class="d-flex justify-content-between mb-4">
                            <span>Amount:</span>
                            <span class="fw-bold" id="modalPackagePrice"></span>
                        </div>
                        <hr>
                    </div>
                </div>
                
                <div class="saf-radio-container mt-3">
                    <div class="saf-radio-option">
                        <input type="radio" id="myNumber" name="purchase_type" value="my_number" checked>
                        <label for="myNumber">Buy for my number</label>
                    </div>
                    <div class="saf-radio-option">
                        <input type="radio" id="otherNumber" name="purchase_type" value="other_number">
                        <label for="otherNumber">Buy for other number</label>
                    </div>
                </div>
                
                <div id="myNumberFields" class="fade-in">
                    <p class="saf-field-label">Number to receive offer</p>
                    <input type="number" placeholder="Enter Number" class="saf-input" id="receiverNumber" name="receiver_number" required pattern="^0[0-9]{9}$|^254[0-9]{9}$" title="Please enter a valid Kenyan phone number (starting with 0 or 254 followed by 9 digits)">
                </div>
                
                <div id="otherNumberFields" class="fade-in" style="display: none;">
                    <p class="saf-field-label">Number to receive offer</p>
                    <input type="number" placeholder="Enter Number" class="saf-input" id="otherReceiverNumber" name="other_receiver_number" pattern="^0[0-9]{9}$|^254[0-9]{9}$" title="Please enter a valid Kenyan phone number (starting with 0 or 254 followed by 9 digits)">
                    
                    <p class="saf-field-label">Number to make payment</p>
                    <input type="number" placeholder="Enter Number" class="saf-input" id="paymentNumber" name="payment_number" pattern="^0[0-9]{9}$|^254[0-9]{9}$" title="Please enter a valid Kenyan phone number (starting with 0 or 254 followed by 9 digits)">
                </div>
            </div>
            <div class="saf-modal-footer">
                <button type="button" class="saf-btn saf-btn-cancel" id="cancelBtn">Cancel</button>
                <button type="submit" class="saf-btn saf-btn-purchase" id="purchaseBtn">Complete Payment</button>
            </div>
        </form>
    </div>
</div>

{% if request.user.is_superuser or request.user.is_staff %}
 <!-- Add Package Modal -->
<div id="addPackageModal" class="saf-modal">
    <div class="saf-modal-content">
        <form id="addPackageForm" method="POST" action="{% url 'add_package' %}">
            {% csrf_token %}
            
            <div class="saf-modal-header">
                <svg class="saf-logo" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 6C12.268 6 6 12.268 6 20C6 27.732 12.268 34 20 34C27.732 34 34 27.732 34 20C34 12.268 27.732 6 20 6Z" fill="#0046AD"/>
                    <path d="M16.75 14C16.75 12.208 18.208 10.75 20 10.75C21.792 10.75 23.25 12.208 23.25 14C23.25 15.792 21.792 17.25 20 17.25C18.208 17.25 16.75 15.792 16.75 14Z" fill="#00A651"/>
                    <path d="M14 20C14 18.208 15.458 16.75 17.25 16.75C19.042 16.75 20.5 18.208 20.5 20C20.5 21.792 19.042 23.25 17.25 23.25C15.458 23.25 14 21.792 14 20Z" fill="#00A651"/>
                    <path d="M17.25 22.75C17.25 20.958 18.708 19.5 20.5 19.5C22.292 19.5 23.75 20.958 23.75 22.75C23.75 24.542 22.292 26 20.5 26C18.708 26 17.25 24.542 17.25 22.75Z" fill="#00A651"/>
                </svg>
                <h4>Add New Package</h4>
            </div>

            <div class="saf-modal-body">
                <div class="mb-3">
                    <label for="name" class="saf-field-label">Package Name</label>
                    <input type="text" class="saf-input" id="name" name="name" required>
                </div>
                
                <div class="mb-3">
                    <label for="price" class="saf-field-label">Price</label>
                    <input type="number" class="saf-input" id="price" name="price" required>
                </div>

                <div class="mb-3">
                    <label for="category" class="saf-field-label">Category</label>
                    <select class="saf-input" id="category" name="category" required>
                        <option value="DATA">Data</option>
                        <option value="SMS">SMS</option>
                        <option value="MINUTES">Minutes</option>
                    </select>
                </div>
            </div>

            <div class="saf-modal-footer">
                <button type="button" class="saf-btn saf-btn-cancel closeAddModal">Cancel</button>
                <button type="submit" class="saf-btn saf-btn-purchase">Save Package</button>
            </div>
        </form>
    </div>
</div>

<!-- Edit Package Modal -->
<div id="editPackageModal" class="saf-modal">
    <div class="saf-modal-content">
        <form id="editPackageForm" method="POST" action="">
            {% csrf_token %}
            
            <div class="saf-modal-header">
                <svg class="saf-logo" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 6C12.268 6 6 12.268 6 20C6 27.732 12.268 34 20 34C27.732 34 34 27.732 34 20C34 12.268 27.732 6 20 6Z" fill="#0046AD"/>
                    <path d="M16.75 14C16.75 12.208 18.208 10.75 20 10.75C21.792 10.75 23.25 12.208 23.25 14C23.25 15.792 21.792 17.25 20 17.25C18.208 17.25 16.75 15.792 16.75 14Z" fill="#00A651"/>
                    <path d="M14 20C14 18.208 15.458 16.75 17.25 16.75C19.042 16.75 20.5 18.208 20.5 20C20.5 21.792 19.042 23.25 17.25 23.25C15.458 23.25 14 21.792 14 20Z" fill="#00A651"/>
                    <path d="M17.25 22.75C17.25 20.958 18.708 19.5 20.5 19.5C22.292 19.5 23.75 20.958 23.75 22.75C23.75 24.542 22.292 26 20.5 26C18.708 26 17.25 24.542 17.25 22.75Z" fill="#00A651"/>
                </svg>
                <h4>Edit Package</h4>
            </div>

            <div class="saf-modal-body">
                <div class="mb-3">
                    <label for="edit_name" class="saf-field-label">Package Name</label>
                    <input type="text" class="saf-input" id="edit_name" name="name" required>
                </div>
                
                <div class="mb-3">
                    <label for="edit_price" class="saf-field-label">Price</label>
                    <input type="number" class="saf-input" id="edit_price" name="price" required>
                </div>
                <div class="mb-3">
                    <label for="edit_category" class="saf-field-label">Category</label>
                    <select class="saf-input" id="edit_category" name="category" required>
                        <option value="DATA">Data</option>
                        <option value="SMS">SMS</option>
                        <option value="MINUTES">Minutes</option>
                    </select>
                </div>
            </div>

            <div class="saf-modal-footer">
                <button type="button" class="saf-btn saf-btn-cancel closeEditModal">Cancel</button>
                <button type="submit" class="saf-btn saf-btn-purchase">Update Package</button>
            </div>
        </form>
    </div>
</div>

<!-- Delete Package Modal -->
<div id="deletePackageModal" class="saf-modal">
    <div class="saf-modal-content">
        <form id="deletePackageForm" method="POST" action="">
            {% csrf_token %}
            
            <div class="saf-modal-header">
                <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="20" cy="20" r="20" fill="#dc3545"/>
                    <path d="M20 10C14.48 10 10 14.48 10 20C10 25.52 14.48 30 20 30C25.52 30 30 25.52 30 20C30 14.48 25.52 10 20 10ZM22.5 25.5L20 23L17.5 25.5L14.5 22.5L17 20L14.5 17.5L17.5 14.5L20 17L22.5 14.5L25.5 17.5L23 20L25.5 22.5L22.5 25.5Z" fill="white"/>
                </svg>
                <h4>Delete Package</h4>
            </div>

            <div class="saf-modal-body text-center">
                <p>Are you sure you want to delete this package?</p>
                <p class="fw-bold" id="deletePackageName"></p>
                <p class="text-danger">This action cannot be undone.</p>
            </div>

            <div class="saf-modal-footer">
                <button type="button" class="saf-btn saf-btn-cancel closeDeleteModal">Cancel</button>
                <button type="submit" class="saf-btn saf-btn-delete">Delete Package</button>
            </div>
        </form>
    </div>
</div>

{% endif %}

<!-- Add messages container -->
<div id="messages-container"></div>


<style>
    /* Add these animations and hover effects */
    .share-btn {
        transform: translateY(0);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .share-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }
    
    .share-btn:active {
        transform: translateY(1px);
    }
    
    .category-icon {
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.05);
        }
        100% {
            transform: scale(1);
        }
    }
    
    /* Improve mobile responsiveness */
    @media (max-width: 768px) {
        .share-btn {
            min-width: 130px !important;
            font-size: 0.9rem;
        }
        
        .share-buttons-container .share-btn svg {
            width: 22px;
            height: 22px;
        }
    }
    </style>
<!-- JavaScript -->
<script>
    // DOM Elements
    const purchaseModal = document.getElementById('purchaseModal');
    const cancelBtn = document.getElementById('cancelBtn');
    const purchaseBtn = document.getElementById('purchaseBtn');
    const myNumberRadio = document.getElementById('myNumber');
    const otherNumberRadio = document.getElementById('otherNumber');
    const myNumberFields = document.getElementById('myNumberFields');
    const otherNumberFields = document.getElementById('otherNumberFields');
    const mpesaForm = document.getElementById('mpesaPaymentForm');
    
    // Get all modal open buttons
    const openModalBtns = document.querySelectorAll('.openModalBtn');
    
    // Add click event to all open buttons
    openModalBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            // Get package data from data attributes
            const packageName = btn.getAttribute('data-package-name');
            const packagePrice = btn.getAttribute('data-package-price');
            
            // Set values in hidden form fields
            document.getElementById('package_id').value = packageName;
            document.getElementById('amount').value = packagePrice;
            
            // Update modal display text
            document.getElementById('modalPackageName').textContent = packageName;
            document.getElementById('modalPackagePrice').textContent = 'Kes ' + packagePrice;
            
            // Open modal with animation
            purchaseModal.style.display = 'block';
            // Force reflow before adding the show class
            void purchaseModal.offsetWidth;
            purchaseModal.classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent scrolling when modal is open
        });
    });
    
    // Close modal with animation
    cancelBtn.addEventListener('click', () => {
        closeModal();
    });
    
    // Close modal function with animation
    function closeModal() {
        purchaseModal.classList.remove('show');
        // Wait for animation to complete before hiding the modal
        setTimeout(() => {
            purchaseModal.style.display = 'none';
            document.body.style.overflow = ''; // Re-enable scrolling
        }, 300);
    }
    
    // Close modal when clicking outside
    purchaseModal.addEventListener('click', (e) => {
        if (e.target === purchaseModal) {
            closeModal();
        }
    });
    
    // Handle radio button changes
    myNumberRadio.addEventListener('change', updateFieldsDisplay);
    otherNumberRadio.addEventListener('change', updateFieldsDisplay);
    
    // Update fields display based on selected radio button
    function updateFieldsDisplay() {
        if (myNumberRadio.checked) {
            otherNumberFields.style.display = 'none';
            // Reset validation
            document.getElementById('otherReceiverNumber').required = false;
            document.getElementById('paymentNumber').required = false;
            document.getElementById('receiverNumber').required = true;
            
            // Wait for the hide animation to complete
            setTimeout(() => {
                myNumberFields.style.display = 'block';
                // Force reflow before applying animation
                void myNumberFields.offsetWidth;
                myNumberFields.classList.add('fade-in');
            }, 50);
        } else {
            myNumberFields.style.display = 'none';
            // Update validation
            document.getElementById('receiverNumber').required = false;
            document.getElementById('otherReceiverNumber').required = true;
            document.getElementById('paymentNumber').required = true;
            
            // Wait for the hide animation to complete
            setTimeout(() => {
                otherNumberFields.style.display = 'block';
                // Force reflow before applying animation
                void otherNumberFields.offsetWidth;
                otherNumberFields.classList.add('fade-in');
            }, 50);
        }
    }
    
    // Form validation
    function validatePhoneNumber(number) {
        const pattern = /^0[0-9]{9}$|^254[0-9]{9}$/;
        return pattern.test(number);
    }
    
    // Form submission handler
    mpesaForm.addEventListener('submit', function(e) {
        let isValid = true;
        
        // Validate based on which option is selected
        if (myNumberRadio.checked) {
            const receiverNumber = document.getElementById('receiverNumber');
            
            if (!validatePhoneNumber(receiverNumber.value)) {
                receiverNumber.classList.add('error');
                isValid = false;
            } else {
                receiverNumber.classList.remove('error');
            }
        } else {
            const otherReceiverNumber = document.getElementById('otherReceiverNumber');
            const paymentNumber = document.getElementById('paymentNumber');
            
            if (!validatePhoneNumber(otherReceiverNumber.value)) {
                otherReceiverNumber.classList.add('error');
                isValid = false;
            } else {
                otherReceiverNumber.classList.remove('error');
            }
            
            if (!validatePhoneNumber(paymentNumber.value)) {
                paymentNumber.classList.add('error');
                isValid = false;
            } else {
                paymentNumber.classList.remove('error');
            }
        }
        
        if (!isValid) {
            e.preventDefault();
            return false;
        }
        
        // If form is valid, disable button and show processing state
        purchaseBtn.disabled = true;
        purchaseBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Processing...';
        
        return true;
    });
     // Package management modal scripts
     document.addEventListener('DOMContentLoaded', function() {
        // DOM Elements for package management
        const addPackageModal = document.getElementById('addPackageModal');
        const editPackageModal = document.getElementById('editPackageModal');
        const deletePackageModal = document.getElementById('deletePackageModal');
        
        const addPackageBtn = document.getElementById('addPackageBtn');
        const editPackageBtns = document.querySelectorAll('.editPackageBtn');
        const deletePackageBtns = document.querySelectorAll('.deletePackageBtn');
        
        const closeAddModalBtn = document.querySelector('.closeAddModal');
        const closeEditModalBtn = document.querySelector('.closeEditModal');
        const closeDeleteModalBtn = document.querySelector('.closeDeleteModal');
        
        // Add Package Modal
        addPackageBtn.addEventListener('click', () => {
            addPackageModal.style.display = 'block';
            void addPackageModal.offsetWidth;
            addPackageModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        });
       
        closeAddModalBtn.addEventListener('click', () => {
            closeModal(addPackageModal);
        });
        
        // Edit Package Modal
        editPackageBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const packageId = btn.getAttribute('data-package-id');
                const packageName = btn.getAttribute('data-package-name');
                const packagePrice = btn.getAttribute('data-package-price');
                const packageCategory = btn.getAttribute('data-package-category');
                
                // Set form action
                document.getElementById('editPackageForm').action = `/package/${packageId}/edit/`;
                
                // Populate form fields
                document.getElementById('edit_name').value = packageName;
                document.getElementById('edit_price').value = packagePrice;
                document.getElementById('edit_category').value = packageCategory;
                
                // Show modal
                editPackageModal.style.display = 'block';
                void editPackageModal.offsetWidth;
                editPackageModal.classList.add('show');
                document.body.style.overflow = 'hidden';
            });
        });
       
        closeEditModalBtn.addEventListener('click', () => {
            closeModal(editPackageModal);
        });
        
        // Delete Package Modal
        deletePackageBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const packageId = btn.getAttribute('data-package-id');
                const packageName = btn.getAttribute('data-package-name');
                
                // Set form action
                document.getElementById('deletePackageForm').action = `/package/${packageId}/delete/`;
                
                // Update modal content
                document.getElementById('deletePackageName').textContent = packageName;
                
                // Show modal
                deletePackageModal.style.display = 'block';
                void deletePackageModal.offsetWidth;
                deletePackageModal.classList.add('show');
                document.body.style.overflow = 'hidden';
            });
        });
        
        closeDeleteModalBtn.addEventListener('click', () => {
            closeModal(deletePackageModal);
        });
        
        // Generic close modal function
        function closeModal(modal) {
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }, 300);
        }
        
        // Close on outside click
        [addPackageModal, editPackageModal, deletePackageModal].forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal(modal);
                }
            });
        });
        
      // Display messages with modern JavaScript
      const showMessage = (text, type) => {
        // Map Django message tags to SweetAlert types
        const typeMap = {
          'success': 'success',
          'error': 'error',
          'danger': 'error',
          'info': 'info',
          'warning': 'warning'
        };
        
        // Use mapped type or default to 'info'
        const alertType = typeMap[type] || 'info';
        
        // Show the SweetAlert notification
        Swal.fire({
          title: '',
          text: text,
          icon: alertType,
          toast: true,
          position: 'top-end',
          showConfirmButton: false,
          timer: 5000,
          timerProgressBar: true,
          didOpen: (toast) => {
            toast.addEventListener('mouseenter', Swal.stopTimer);
            toast.addEventListener('mouseleave', Swal.resumeTimer);
          }
        });
      };
      
      // Example of how to use this in your JavaScript when handling AJAX responses:
      // showMessage("Your changes have been saved!", "success");
      
      // For Django template usage, you can include this script:
      document.addEventListener('DOMContentLoaded', () => {
        // Process Django messages on page load
        const djangoMessages = JSON.parse(document.getElementById('django-messages').textContent || '[]');
        djangoMessages.forEach(message => {
          showMessage(message.text, message.tags);
        });
      });
        // Handle form submissions with AJAX
        const forms = [
            {form: document.getElementById('addPackageForm'), modal: addPackageModal},
            {form: document.getElementById('editPackageForm'), modal: editPackageModal},
            {form: document.getElementById('deletePackageForm'), modal: deletePackageModal}
        ];
        
        forms.forEach(({form, modal}) => {
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(form);
                
                fetch(form.action, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    closeModal(modal);
                    
                    if(data.success) {
                        showMessage(data.message, 'success');
                        // Reload the page to show updated packages
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else {
                        showMessage(data.message || 'An error occurred', 'danger');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showMessage('An error occurred while processing your request', 'danger');
                });
            });
        });
    });
    document.addEventListener('DOMContentLoaded', function() {
        // Generate the share text with all packages
        function generateShareText() {
            let shareText = "🔥 Unbeatable Deals Just for You! Stay Connected for Less with Bingwa Sokoni! 🔥\n\n";
            
            // Add the intro text (using += instead of = to append instead of overwrite)
            shareText += "🚀 Powered by INNOVESTRA TECH ENTERPRISES, we bring you the cheapest, fastest, and most reliable data, SMS, and minute bundles in Kenya! Whether you need to browse, chat, or call, we've got you covered—with or without Okoa Jahazi! 💡\n\n";
            
            shareText += "💸 Pay instantly via TILL NUMBER: 9445283 (INNOVESTRA TECH ENTERPRISES) and enjoy seamless connectivity in seconds! 🔥\n\n";
            
            // Data Bundles
            shareText += "📶 HOT DATA BUNDLES – Surf More, Pay Less!\n";
            {% for package in packages %}
            {% if package.category == 'DATA' %}
            shareText += "• {{ package.name }}: KES {{ package.price }}\n";
            {% endif %}
            {% endfor %}
            
            // SMS Bundles
            shareText += "\n💬 SMS BUNDLES – Text Non-Stop for Cheap!\n";
            {% for package in packages %}
            {% if package.category == 'SMS' %}
            shareText += "• {{ package.name }}: KES {{ package.price }}\n";
            {% endif %}
            {% endfor %}
            
            // Minutes Bundles
            shareText += "\n📞 MINUTES BUNDLES – Talk for Longer, Pay Less!\n";
            {% for package in packages %}
            {% if package.category == 'MINUTES' %}
            shareText += "• {{ package.name }}: KES {{ package.price }}\n";
            {% endif %}
            {% endfor %}
            
            shareText += "\n🛒 Grab yours now! Visit {{ request.build_absolute_uri }}";
            shareText += "\n\n👉 Share this with your friends and family to help them save too!";
            shareText += "\n\n📞 Need help? Call/WhatsApp: 0795477371 / 0111755871\n";
            
            shareText += "\n\n#BingwaSokoni #InnovestraTech #DataBundles #SMSBundles #MinutesBundles #KenyaDeals #StayConnected";
            
            return encodeURIComponent(shareText);
        }
        
        // Share buttons event listeners
        const shareText = generateShareText();
        const pageUrl = encodeURIComponent(window.location.href);
        
        // WhatsApp Share
        document.getElementById('shareWhatsApp').addEventListener('click', function() {
            window.open(`https://wa.me/?text=${shareText}`, '_blank');
        });
        
        // Facebook Share
        document.getElementById('shareFacebook').addEventListener('click', function() {
            // Copy text to clipboard and show instructions
            navigator.clipboard.writeText(decodeURIComponent(shareText))
                .then(() => {
                    Swal.fire({
                        title: 'Text Copied!',
                        text: 'Package details copied to clipboard. You can now paste it on Facebook.',
                        icon: 'success',
                        confirmButtonText: 'Open Facebook',
                        showCancelButton: true,
                        cancelButtonText: 'Cancel'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            // Try to open Facebook app on mobile or website on desktop
                            window.open('fb://facewebmodal/f?href=' + pageUrl, '_blank');
                            // Fallback to Facebook website if app doesn't open
                            setTimeout(function() {
                                window.open('https://www.facebook.com/', '_blank');
                            }, 1000);
                        }
                    });
                })
                .catch(err => {
                    console.error('Failed to copy text: ', err);
                    Swal.fire({
                        title: 'Error',
                        text: 'Failed to copy package details.',
                        icon: 'error'
                    });
                });
        });
        
        // X (Twitter) Share
        document.getElementById('shareTwitter').addEventListener('click', function() {
            window.open(`https://twitter.com/intent/tweet?text=${shareText}&url=${pageUrl}`, '_blank');
        });
        
        // Instagram Share (will open Instagram app if on mobile)
        document.getElementById('shareInstagram').addEventListener('click', function() {
            // Instagram doesn't have a direct sharing API like other platforms
            // This is a workaround - copy text to clipboard and open Instagram
            navigator.clipboard.writeText(decodeURIComponent(shareText))
                .then(() => {
                    Swal.fire({
                        title: 'Text Copied!',
                        text: 'Package details copied to clipboard. You can now paste it in Instagram.',
                        icon: 'success',
                        confirmButtonText: 'Open Instagram',
                        showCancelButton: true,
                        cancelButtonText: 'Cancel'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            // Try to open Instagram app on mobile or website on desktop
                            window.open('instagram://app', '_blank');
                            // Fallback to Instagram website if app doesn't open
                            setTimeout(function() {
                                window.open('https://www.instagram.com/', '_blank');
                            }, 1000);
                        }
                    });
                })
                .catch(err => {
                    console.error('Failed to copy text: ', err);
                    Swal.fire({
                        title: 'Error',
                        text: 'Failed to copy package details.',
                        icon: 'error'
                    });
                });
        });
        
        // SMS Share
        document.getElementById('shareSMS').addEventListener('click', function() {
            // On mobile devices, this will open the native SMS app
            window.open(`sms:?body=${shareText}`, '_blank');
        });
    });
</script>
{% if messages %}
<script id="django-messages" type="application/json">
  [
    {% for message in messages %}
      {
        "text": "{{ message|escapejs }}",
        "tags": "{{ message.tags }}"
      }{% if not forloop.last %},{% endif %}
    {% endfor %}
  ]
</script>
{% endif %}
{% endblock content %}